<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéì</text></svg>">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore-compat.js"></script>
    
    <!-- Global Logout Function -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD7CpErf98utaNmXfXyJGK_YY9JY0f7jSY",
            authDomain: "nyikarisanawebsite-html.firebaseapp.com",
            projectId: "nyikarisanawebsite-html",
            storageBucket: "nyikarisanawebsite-html.firebasestorage.app",
            messagingSenderId: "454911232732",
            appId: "1:454911232732:web:84a2540f5f342c06fd8219",
            measurementId: "G-KN4N9FW2H1"
        };

        // Wait for Firebase to load before defining functions
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Firebase with compat version
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();

            // Global logout function
            window.logout = function() {
                auth.signOut().then(() => {
                    alert('Logged out successfully');
                    window.location.href = 'index.html';
                }).catch((error) => {
                    console.error('Error logging out:', error);
                    alert('Error logging out. Please try again.');
                });
            };
        });
    </script>
</head>
<body class="dashboard-body">
    <!-- Top Navigation -->
    <div class="top-nav">
        <button id="logout-btn" onclick="logout()" class="logout-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16,17 21,12 16,7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Logout
        </button>
        
        <button id="notification-btn" onclick="toggleNotifications()" class="notification-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            Notifications
            <span id="notification-badge" class="notification-badge hidden">3</span>
        </button>
    </div>

    <!-- Notification Panel -->
    <div id="notification-panel" class="notification-panel hidden">
        <div class="notification-header">
            <h3>Notifications</h3>
            <button onclick="closeNotifications()" class="close-btn">&times;</button>
        </div>
        <div id="notifications-list" class="notifications-list">
            <div class="notification-item">
                <div class="notification-icon admin">A</div>
                <div class="notification-content">
                    <strong>Admin:</strong> School holiday announced for next week.
                    <span class="notification-time">2 hours ago</span>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-icon teacher">T</div>
                <div class="notification-content">
                    <strong>Teacher:</strong> Remember to submit your assignments by Friday.
                    <span class="notification-time">5 hours ago</span>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-icon principal">P</div>
                <div class="notification-content">
                    <strong>Principal:</strong> Parent-teacher meeting scheduled for next month.
                    <span class="notification-time">1 day ago</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Student Profile Header -->
        <div class="profile-header">
            <div class="profile-info">
                <div class="profile-avatar">
                    <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <div class="profile-details">
                    <h1 id="student-name">Loading...</h1>
                    <p id="student-info">Student ID: Loading... | Grade: 10</p>
                    <p id="student-email">Loading...</p>
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-info">
                    <h3>Overall Grade</h3>
                    <p class="stat-value">85%</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-info">
                    <h3>Attendance</h3>
                    <p class="stat-value">90%</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-info">
                    <h3>Behavior</h3>
                    <p class="stat-value">Good</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Sections -->
        <div class="dashboard-grid">
            <!-- Personal Information -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('personal-info')">
                    <h2>Personal Information</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="personal-info" class="card-content hidden">
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Name:</label>
                            <span id="display-name">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Age:</label>
                            <span>16</span>
                        </div>
                        <div class="info-item">
                            <label>Address:</label>
                            <span id="display-address">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Phone:</label>
                            <span id="display-phone">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Identity Number:</label>
                            <span id="display-identity">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Parent Information -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('parent-info')">
                    <h2>Parent Information</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="parent-info" class="card-content hidden">
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Name:</label>
                            <span>Jane Doe</span>
                        </div>
                        <div class="info-item">
                            <label>Phone:</label>
                            <span>+0987654321</span>
                        </div>
                        <div class="info-item">
                            <label>Email:</label>
                            <span>jane.doe@example.com</span>
                        </div>
                        <div class="info-item">
                            <label>Relationship:</label>
                            <span>Mother</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Overview -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('performance-overview')">
                    <h2>Performance Overview</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="performance-overview" class="card-content hidden">
                    <div class="performance-summary">
                        <div class="performance-item good">
                            <label>Overall Grade:</label>
                            <span>85%</span>
                        </div>
                        <div class="performance-item excellent">
                            <label>Strengths:</label>
                            <span>Science, Mathematics</span>
                        </div>
                        <div class="performance-item warning">
                            <label>Areas for Improvement:</label>
                            <span>English, History</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="performance-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Attendance Report -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('attendance-report')">
                    <h2>Attendance Report</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="attendance-report" class="card-content hidden">
                    <div class="attendance-summary">
                        <div class="attendance-item present">
                            <label>Present:</label>
                            <span>90%</span>
                        </div>
                        <div class="attendance-item absent">
                            <label>Absent:</label>
                            <span>10%</span>
                        </div>
                        <div class="attendance-item late">
                            <label>Late:</label>
                            <span>5%</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="attendance-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Behavior Report -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('behavior-report')">
                    <h2>Behavior Report</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="behavior-report" class="card-content hidden">
                    <div class="behavior-grid">
                        <div class="behavior-item excellent">
                            <label>Respect:</label>
                            <span>Excellent</span>
                        </div>
                        <div class="behavior-item good">
                            <label>Responsibility:</label>
                            <span>Good</span>
                        </div>
                        <div class="behavior-item average">
                            <label>Teamwork:</label>
                            <span>Average</span>
                        </div>
                        <div class="behavior-item good">
                            <label>Participation:</label>
                            <span>Good</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed Analytics -->
            <div class="dashboard-card full-width">
                <button class="card-header" onclick="toggleSection('detailed-analytics')">
                    <h2>Detailed Analytics</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="detailed-analytics" class="card-content hidden">
                    <div class="analytics-tabs">
                        <button class="analytics-tab active" onclick="showAnalytics('weekly')">Weekly</button>
                        <button class="analytics-tab" onclick="showAnalytics('monthly')">Monthly</button>
                        <button class="analytics-tab" onclick="showAnalytics('term')">Term</button>
                    </div>
                    
                    <div id="weekly-analytics" class="analytics-content active">
                        <h4>Weekly Performance</h4>
                        <div class="progress-list">
                            <div class="progress-item">
                                <span>Week 1:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 75%;">75%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>Week 2:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 85%;">85%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>Week 3:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 90%;">90%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="monthly-analytics" class="analytics-content">
                        <h4>Monthly Performance</h4>
                        <div class="progress-list">
                            <div class="progress-item">
                                <span>January:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 80%;">80%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>February:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 85%;">85%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>March:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 90%;">90%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="term-analytics" class="analytics-content">
                        <h4>Term Performance</h4>
                        <div class="progress-list">
                            <div class="progress-item">
                                <span>Term 1:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 82%;">82%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>Term 2:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 86%;">86%</div>
                                </div>
                            </div>
                            <div class="progress-item">
                                <span>Term 3:</span>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 90%;">90%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Generate Report -->
            <div class="dashboard-card">
                <button class="card-header" onclick="generateReport()">
                    <h2>Generate Report</h2>
                    <span class="generate-icon">üìÑ</span>
                </button>
                <div id="report-section" class="card-content hidden">
                    <h4>Student Summary Report</h4>
                    <div id="report-content" class="report-content"></div>
                    <button class="download-btn" onclick="downloadReport()">Download PDF</button>
                </div>
            </div>

            <!-- Feedback Section -->
            <div class="dashboard-card">
                <button class="card-header" onclick="toggleSection('feedback-section')">
                    <h2>Give Feedback</h2>
                    <span class="toggle-icon">+</span>
                </button>
                <div id="feedback-section" class="card-content hidden">
                    <form id="feedback-form" class="feedback-form">
                        <div class="form-group">
                            <label>Your Name:</label>
                            <input type="text" id="feedback-name" required>
                        </div>
                        <div class="form-group">
                            <label>Teacher's Name:</label>
                            <input type="text" id="teacher-name" required>
                        </div>
                        <div class="form-group">
                            <label>Your Feedback:</label>
                            <textarea id="feedback-message" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Behavior Rating:</label>
                            <select id="behavior-rating" required>
                                <option value="">Select Rating</option>
                                <option value="Excellent">Excellent</option>
                                <option value="Good">Good</option>
                                <option value="Average">Average</option>
                                <option value="Below Average">Below Average</option>
                                <option value="Poor">Poor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Performance Rating:</label>
                            <select id="performance-rating" required>
                                <option value="">Select Rating</option>
                                <option value="Excellent">Excellent</option>
                                <option value="Good">Good</option>
                                <option value="Average">Average</option>
                                <option value="Below Average">Below Average</option>
                                <option value="Poor">Poor</option>
                            </select>
                        </div>
                        <button type="submit" class="submit-btn">Submit Feedback</button>
                    </form>
                    
                    <div id="feedback-list" class="feedback-list">
                        <h4>Previous Feedback</h4>
                        <div class="feedback-item">
                            <strong>From: Math Teacher</strong>
                            <p>Great improvement in algebra. Keep up the good work!</p>
                            <span class="feedback-date">March 15, 2025</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Module Scripts -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="student-dashboard.js"></script>
</body>
</html>
